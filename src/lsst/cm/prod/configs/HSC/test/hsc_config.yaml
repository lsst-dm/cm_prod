prepare:
    class_name: lsst.cm.tools.db.script_handler.PrepareScriptHandler
ancil:
    class_name: lsst.cm.tools.db.script_handler.AncillaryScriptHandler
    collections:
        - HSC/calib
        - HSC/masks
        - HSC/fgcmcal/lut/RC2
        - refcats
        - skymaps
collect:
    class_name: lsst.cm.tools.db.script_handler.CollectScriptHandler
collect_step:
    class_name: lsst.cm.tools.db.script_handler.CollectStepScriptHandler
job:
    class_name: lsst.cm.prod.HSC.handler.HSCJobHandler
    bps_template_yaml: "${CM_CONFIGS}/hsc_template.yaml"
    bps_script_template: "${CM_CONFIGS}/hsc_bps_template.sh"
    pipeline_yaml:
        step1: "${DRP_PIPE_DIR}/pipelines/HSC/DRP-RC2.yaml#step1"
        step2: "${DRP_PIPE_DIR}/pipelines/HSC/DRP-RC2.yaml#step2"
        step3: "${DRP_PIPE_DIR}/pipelines/HSC/DRP-RC2.yaml#step3"
        step4: "${DRP_PIPE_DIR}/pipelines/HSC/DRP-RC2.yaml#step4"
        step5: "${DRP_PIPE_DIR}/pipelines/HSC/DRP-RC2.yaml#step5"
        step6: "${DRP_PIPE_DIR}/pipelines/HSC/DRP-RC2.yaml#step6"
        step7: "${DRP_PIPE_DIR}/pipelines/HSC/DRP-RC2.yaml#step7"
workflow:
    class_name: lsst.cm.tools.db.workflow_handler.WorkflowHandler
    input_type: source
    output_type: run
    job_config: job
group:
    class_name: lsst.cm.tools.db.group_handler.GroupHandler
    input_type: tagged
    output_type: chained
    templates:
        coll_in: "{root_coll}/{production_name}/{campaign_name}/{step_name}/{group_name}_input"
        coll_out: "{root_coll}/{production_name}/{campaign_name}/{step_name}/{group_name}_output"
    scripts:
        - prepare
step:
    input_type: source
    output_type: tagged
    templates:
        coll_out: "{root_coll}/{production_name}/{campaign_name}/{step_name}_output"
    scripts:
        - prepare
        - collect_step
step1:
    class_name: lsst.cm.prod.HSC.handler.HSCStep1Handler
    prerequisites: []
    includes: ["step"]
step2:
    class_name: lsst.cm.prod.HSC.handler.HSCStep2Handler
    prerequisites: ["step1"]
    includes: ["step"]
step3:
    class_name: lsst.cm.prod.HSC.handler.HSCStep3Handler
    prerequisites: ["step2"]
    includes: ["step"]
step4:
    class_name: lsst.cm.prod.HSC.handler.HSCStep4Handler
    prerequisites: ["step3"]
    includes: ["step"]
step5:
    class_name: lsst.cm.prod.HSC.handler.HSCStep5Handler
    prerequisites: ["step4"]
    includes: ["step"]
step6:
    class_name: lsst.cm.prod.HSC.handler.HSCStep6Handler
    prerequisites: ["step5"]
    includes: ["step"]
step7:
    class_name: lsst.cm.prod.HSC.handler.HSCStep7Handler
    prerequisites: ["step6"]
    includes: ["step"]
campaign:
    class_name: lsst.cm.tools.db.campaign_handler.CampaignHandler
    root_coll: u/echarles/cm
    data_query: "instrument = 'HSC' and exposure < 500"
    input_type: tagged
    output_type: chained
    templates:
        coll_source: HSC/raw/RC2
        coll_in: "{root_coll}/{production_name}/{campaign_name}_input"
        coll_out: "{root_coll}/{production_name}/{campaign_name}_output"
        coll_ancil: "{root_coll}/{production_name}/{campaign_name}_ancil"
    scripts:
        - ancil
        - prepare
        - collect
    steps:
        - step1
        - step2
        - step3
        - step4
        - step5
        - step6
        - step7
